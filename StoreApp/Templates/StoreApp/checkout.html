{% extends 'StoreApp/main.html' %}
{% load static %}
{% block content %}

<h1>Checkout</h1>

<a href="{% url 'cart' %}">Cart</a>

<div style="margin: 0px 0px;">

     <div>
		<div>
               <a href="{% url 'cart' %}" >&#x2190; Back to Cart</a>
			<hr>
			<h3>Order Outline</h3>
               <hr>
               {% for item in items %}
			<div>
				<div style="flex:2"><img src="{{item.tech.pictureURL}}" style="height: 100px;"></div>
				<div style="flex:2"><p>{{item.tech.name}}</p></div>
				<div style="flex:1"><p>৳{{item.tech.price|floatformat:2}}</p></div>
				<div style="flex:1"><p>x{{item.quantity}}</p></div>
               </div>
               {% endfor %}
			<h5>Items:   {{order.get_cart_items}}</h5>
			<h5>Total:   ৳{{order.get_cart_total}}</h5>
               
		</div>
	</div>

	<div>
		<div id="form-wrapper">
               <form id="form" >
                    <div id="user-info" >
                         <div >
                              <input required type="text" name="name" placeholder="Name..">
                         </div>
                         <div>
                              <input required type="email" name="email" placeholder="Email..">
                         </div>
                    </div>
                    
                    <div id="shipping-info">
                         <hr>
                         <p>Shipping Information:</p>
                         <hr>
                         <div>
                              <input type="text" name="address" placeholder="Address..">
                         </div>
                         <div>
                              <input type="text" name="city" placeholder="City..">
                         </div>
                         <div>
                              <input type="text" name="state" placeholder="State..">
                         </div>
                         <div>
                              <input type="text" name="zipcode" placeholder="City Zip code..">
                         </div>
                         <div>
                              <input type="text" name="country" placeholder="Country Zip code..">
                         </div>
                    </div>

                    <hr>
                    <input id="form-button" type="submit" value="Confirm Information" >
               </form>
		</div>
          
          <br>
          <div id="payment-info"  style="margin: 5px" >
               <button id="make-payment" class="pay"> Confirm & Make Payment </button>
          </div>
	</div>

	
</div>
<script type="text/javascript">
     var shipping = '{{order.shipping}}'
     var total = '{{order.get_cart_total}}'

     //Hide entire form if user is not logged in and shipping is false
     if (shipping == 'False') {
          document.getElementById('shipping-info').innerHTML = ''
     }

     //Hide name and email form for logged in user
     if (user != 'AnonymousUser') {
          document.getElementById('user-info').innerHTML = ''
     }

     var form = document.getElementById('form')
     form.addEventListener('submit', function (e){
          e.preventDefault()
          console.log('Form submitted...')
     })

     document.getElementById('make-payment').addEventListener('click', function (e) {
          submitFormData(form, "{% url 'store' %}")
     })
</script>

{% endblock content %}